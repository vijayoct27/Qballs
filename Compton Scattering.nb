(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     30774,        835]
NotebookOptionsPosition[     29442,        784]
NotebookOutlinePosition[     29832,        801]
CellTagsIndexPosition[     29789,        798]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"<<", "Units`"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "PhysicalConstants`"}]}], "Input",
 CellChangeTimes->{{3.703430080007213*^9, 3.703430081086564*^9}, {
  3.70757802739214*^9, 3.707578027479742*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "obspkg"}], "MessageName"], 
  RowBox[{
  ":", " "}], \
"\<\"\[NoBreak]\\!\\(\\*RowBox[{\\\"\\\\\\\"PhysicalConstants`\\\\\\\"\\\"}]\\\
)\[NoBreak] is now obsolete. The legacy version being loaded may conflict \
with current functionality. See the Compatibility Guide for updating \
information.\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.707578030640362*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f", "[", "\[Theta]_", "]"}], ":=", 
  RowBox[{"k", "-", 
   FractionBox["k", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{"k", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ")"}]}], 
      "me"]}]]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[Sigma]d\[CapitalOmega]", "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      SuperscriptBox["\[Alpha]", "2"], 
      SuperscriptBox["me", "2"]], 
     FractionBox[
      SuperscriptBox["P", "2"], "2"], 
     RowBox[{"(", 
      RowBox[{"P", "+", 
       FractionBox["1", "P"], "-", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], ")"}]}], "/.", 
    RowBox[{"P", "\[Rule]", 
     FractionBox["1", 
      RowBox[{"1", "+", 
       RowBox[{
        FractionBox["k", "me"], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ")"}]}]}]]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"comptontrial", "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"3", " ", 
      SuperscriptBox["k", "2"], " ", "me", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "k"}], "+", "me"}], ")"}], "3"]}]], "\[Pi]", " ", 
    SuperscriptBox["\[Alpha]", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "k", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "10"}], " ", 
          SuperscriptBox["k", "4"]}], "+", 
         RowBox[{"51", " ", 
          SuperscriptBox["k", "3"], " ", "me"}], "+", 
         RowBox[{"93", " ", 
          SuperscriptBox["k", "2"], " ", 
          SuperscriptBox["me", "2"]}], "+", 
         RowBox[{"51", " ", "k", " ", 
          SuperscriptBox["me", "3"]}], "+", 
         RowBox[{"9", " ", 
          SuperscriptBox["me", "4"]}]}], ")"}]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "k"}], "+", "me"}], ")"}], "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["k", "2"], "-", 
         RowBox[{"2", " ", "k", " ", "me"}], "-", 
         RowBox[{"3", " ", 
          SuperscriptBox["me", "2"]}]}], ")"}], " ", 
       RowBox[{"Log", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "k"}], "-", "me"}], "]"}]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "k"}], "+", "me"}], ")"}], "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["k", "2"], "-", 
         RowBox[{"2", " ", "k", " ", "me"}], "-", 
         RowBox[{"3", " ", 
          SuperscriptBox["me", "2"]}]}], ")"}], " ", 
       RowBox[{"Log", "[", 
        RowBox[{"-", "me"}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"comptontest", "=", 
   RowBox[{"LogLogPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"n", " ", "comptontrial", 
       RowBox[{"(", "5.`*^5", ")"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"me", "\[Rule]", "0.5"}], ",", 
        RowBox[{"\[Alpha]", "\[Rule]", 
         FractionBox["1", "137"]}], ",", 
        RowBox[{"n", "\[Rule]", "0.8"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       SuperscriptBox["10", 
        RowBox[{"-", "1"}]], ",", 
       SuperscriptBox["10", "10"]}], "}"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", "Dashed"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.70540613498927*^9, 3.705406139158946*^9}, {
  3.707079232853623*^9, 3.7070792580505753`*^9}, {3.707765927822406*^9, 
  3.707765929323823*^9}}],

Cell[CellGroupData[{

Cell["With Pauli-Blocking:", "Subsubsection",
 CellChangeTimes->{{3.705160055962523*^9, 3.70516005792058*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    FractionBox[
     SuperscriptBox["\[Alpha]", "2"], 
     SuperscriptBox["me", "2"]], 
    FractionBox[
     SuperscriptBox["P", "2"], "2"], 
    RowBox[{"(", 
     RowBox[{"P", "+", 
      FractionBox["1", "P"], "-", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}], ")"}]}], "/.", 
   RowBox[{"P", "\[Rule]", 
    FractionBox["1", 
     RowBox[{"1", "+", 
      RowBox[{
       FractionBox["k", "me"], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Cos", "[", "\[Theta]", "]"}]}], ")"}]}]}]]}]}], "/.", 
  RowBox[{
   RowBox[{"Cos", "[", "\[Theta]", "]"}], "\[Rule]", "x"}]}]], "Input",
 CellChangeTimes->{{3.707084302089284*^9, 3.707084309943553*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ff", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"f", "[", "\[Theta]", "]"}], "/.", 
   RowBox[{
    RowBox[{"Cos", "[", "\[Theta]", "]"}], "\[Rule]", 
    "x"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[Sigma]dx", "=", 
   RowBox[{
    FractionBox[
     RowBox[{
      SuperscriptBox["\[Alpha]", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        FractionBox["1", 
         RowBox[{"1", "+", 
          FractionBox[
           RowBox[{"k", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "x"}], ")"}]}], "me"]}]], "+", 
        FractionBox[
         RowBox[{"k", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "x"}], ")"}]}], "me"], "-", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["x", "2"]}], ")"}]}], ")"}]}], 
     RowBox[{"2", " ", 
      SuperscriptBox["me", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", 
         FractionBox[
          RowBox[{"k", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", "x"}], ")"}]}], "me"]}], ")"}], "2"]}]], "*", 
    "2", "Pi"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"comptonpauli", "=", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{"d\[Sigma]dx", "*", 
      RowBox[{"ff", "[", "x", "]"}], "*", "n", 
      FractionBox[
       RowBox[{"ff", "[", "x", "]"}], "Ef"]}], ",", "x"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"comptonnon", "=", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{"d\[Sigma]dx", "*", 
      RowBox[{"ff", "[", "x", "]"}], "n"}], ",", "x"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ff", "[", "x", "]"}], "\[Equal]", "Ef"}], ",", "x"}], "]"}], "//",
   "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.705166381659194*^9, 3.705166401317997*^9}, {
  3.7070792632080927`*^9, 3.707079286855937*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"x", "\[Rule]", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{"Ef", " ", "me"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Ef", "-", "k"}], ")"}], " ", "k"}]]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.707079315143565*^9, 3.707084034427279*^9, 
  3.707578046971607*^9, 3.707764980642283*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pauli1", "=", 
   RowBox[{"comptonpauli", "/.", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{"1", "+", 
      FractionBox[
       RowBox[{"Ef", " ", "me"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Ef", "-", "k"}], ")"}], " ", "k"}]]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pauli2", "=", 
   RowBox[{"comptonpauli", "/.", 
    RowBox[{"x", "\[Rule]", "1"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pauli1non", "=", 
   RowBox[{"comptonnon", "/.", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{"-", "1"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pauli2non", "=", 
   RowBox[{"comptonnon", "/.", 
    RowBox[{"x", "\[Rule]", 
     RowBox[{"1", "+", 
      FractionBox[
       RowBox[{"Ef", " ", "me"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Ef", "-", "k"}], ")"}], " ", "k"}]]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compton2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"pauli1", "-", "pauli2"}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{"pauli1non", "-", "pauli2non"}], ")"}]}], "//", "Simplify"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7051655064032917`*^9, 3.705165541567329*^9}, 
   3.7051673524039993`*^9, {3.705405725362527*^9, 3.705405730188159*^9}, {
   3.705405813778459*^9, 3.70540583150283*^9}, {3.707079294544842*^9, 
   3.707079310160645*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"compton", "=", 
   RowBox[{"LogLogPlot", "[", 
    RowBox[{
     RowBox[{"ReplaceAll", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", "compton2"}], 
         RowBox[{"(", "5.`*^5", ")"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"me", "\[Rule]", "0.5"}], ",", 
          RowBox[{"\[Alpha]", "\[Rule]", 
           FractionBox["1", "137"]}], ",", 
          RowBox[{"Ef", "\[Rule]", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"3", 
              SuperscriptBox["Pi", "2"], "n"}], ")"}], 
            RowBox[{"1", "/", "3"}]]}]}], "}"}]}], ",", 
       RowBox[{"n", "\[Rule]", "0.8"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       SuperscriptBox["10", 
        RowBox[{"-", "2"}]], ",", 
       SuperscriptBox["10", "10"]}], "}"}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"{", "\"\<Compton\>\"", "}"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "Thick"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"comptontest", ",", "compton"}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQrfZo5W3u2a8dPbYdewOiKzoafXmA9KwXB/1AtMPD
viAQ3XfrdwSINis748IHpIV+VHmA6Hd3eOJAdI+tKJjOub9kDoh+WWCzGEQL
ugqsANEFG3TBtJaCn20DkH7zmtUORC/ofFsGoh1+vQfTfM/DOkG0zSbFbhD9
rtPyIYj2WDEBTGu4xf8Hi8dNAtNZqTYxmXNeO/7jdgDTt0wfnQXR/w+kXwTR
2e4SHFlAukJaGkz/u8gQvHHea0fbRBYwbWG7MgNEy7QfBdMHwr8FMix47ViV
oBoEokN6OrpBdJdtN5iO/3tPlxlIH05l1wPRT9bNdwbR72qaXUD0s6nM7CxA
+szjMjANAB7Xsck=
  "]],

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{{{}, {}, {
        Directive[
         Opacity[1.], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6], 
         Dashing[{Small, Small}]], 
        LineBox[CompressedData["
1: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
PGmmmf+d8rYL742vqzphYsr6VBTl/wElJL5Y
         "]]}}}, {{{}, {}, {
        Directive[
         Opacity[1.], 
         AbsoluteThickness[1.6], 
         RGBColor[1, 0, 0], 
         Thickness[Large]], 
        LineBox[CompressedData["
1:eJwVy3s41PkCBnBDLukkNTO/mcztx1Zu2dzmp436vpuKw+YS1SkUKimRS5tV
aqqDiI2miyIJ3TspySXRBelCI+W0ql0KS8lRwyCbmp3zx/u8z+d53tc0dOuy
DdpaWlqxmvy/P3/z8irv/ETaxeoH693YqNU6d397t8aq8tLLoWyUzIjl79FX
krjyJrMzj9k47b4gIs1KSRZ4qxwWDLKRucXwtnypkrx1Op3tMYWD3VkvjE9G
K8k+z+1lgeYcRN4oXHf2sJIU7Y5LDXfhILAtqry4XElE6iKdtd4ceI7Pm1j5
Uklmks3ej4I5mEfrB94bVxJBeLrxt2gO+OH5rNaFg2RTdtX6goMc6GdE+P+x
YZBkBT3xWXWSg5GrTud7UgfJBJsJXfEXOWgdbf5pTDFIIMtk29VyUCc4ma89
OEhW2ebF9D7h4DoJH5zEHSJ0Wvyv819ykLVf67g4YIh0Ju+t7hvg4CeeXZdr
7xBZy8kKG6O4cHb+Kl1qqCI5Ny1XbaK5sFr7KHWFjYqMuU8sOWvJhcH5kO83
xalI8fFGWaYzF/WMPOGgWkV2dVoEbgnionT1mqZss2Fy8aHfnZQNXBTutpIU
LB4mDyKromSRXOxpqK0vTR8mnDfPUqbu4sJlxdCUl7wRstrJ8f3rHC5u/Ox/
7jvbUfJL8fqunhYuik7QY7P9Rkm1JO7c5jYu5DX9nsz2USK/9887r9u5iNZN
VrpXjxLfm9dMUz9wMftomUuU+2cy+ciyTN4ECkU3qOeVwWNkblmWzVZ7Ctqu
fqVT/z1GXntvyeh0ohDaknl489kxkn/1pbnHfAr0gIG/sG+M3LqwUzzqRuGU
+ZdWWdxfRFYgb1EEUsjJ6XixJOULudSi4J5NoiDfc+FV6+WvZKN74DahgsKg
0Z9VNoqvpMPg4g/xzyj45pnmpnz6SsSegrTGFxSMq3IC5kq/kWPFN6xDOigc
HMr4Pff2N1LM7TF1/UThQFhMe2iLmtw3SjEaNubhx1mimF++aMEpuy5V7sXD
pwGdHBMjFrSv+XocW8bD6Yq+2mqaBYueaYKjK3j45l7JYS1hoYiqt0haw0NV
hF9lWhYLFSWpxy2jeLAvSVPnzNRGRqR+X14GD2YuI7/WeOug8USXStbAg86y
5kvaZ3RhsDKhw8KWjwbLsIINZbqoCx19ZuzAxwHW1+yHDbqoptZsH5HyMa3E
Kvnge13scIv+o8qZDzPjlLUmc/RQu2lfnoUbH1C4cOyr9PBn8NWFuUF8JHpc
2hXyVB9TJsy/NZzKh2phss/d8YkQz6z2nfWKj8rDARb9140wJ6j0uyM/T8eS
E5Lfki5OhX/QXxkGY9Ph7sn2udLCRo9D8CSvDSZwtOF1ZlhQuPbX+LtEhQkq
lEKrlJV8cPuFd9abCzCjxz6dKTOB+6g6PV4mwIm93nUd+iJYuxxqHFEIcE4d
WVJoL4HRHN+rbWwhmld4BRo10PhvC/NWvkoIXn7PvLZ2U2TG+rw5eUyIrnna
yeJBM9gfXxTGbxaiaOBswF3hDMhdy/+jN1GEq4c9Jm91mImI1E7DJS4iXPOJ
90wImYWXotJlU2JEkIaYD6vTzBEV6SYNLBRBb11bwuFTFii/Kev2VIjQlDg1
fd9jS5y/5ejf+0WE9v2e8bs7rXC9dWNHxQwxtvUYNI+orHFIvO6o1FMMdaBX
6WOxDa58ML0TFifGi/ojsZcdv8e+ng95+7PFKFi07nZvyBzYGfbv8qoR4/fV
J2KPz7dFux2rMqhDDMuaWuedD2zB/rFoY4lajGhr28ZJQXYY7H4864ypBEHT
xA8L39khICDLeyUkWKzrk94rs4cqYZJZTrAEHwtckzZzHPB49Yv/+cgkIBUV
fUOnHODXoHxvkStBWttWnrXUEdatu94mVUqQEHuhJPyeIyonXoqyfS6BdXnh
3m4PKVplMduv9EvQpvuWZ/RGiq7h5V1PdWhYK/IFCyIYfHoTHMExpvGOVZ57
OZJBr9HHJA+Nz0mbBNOjGVAhr7L3aEznfRaotjHIv+9ypV9jaouv8NJuzf8f
c47WT6WhbagjouQMXCXmfnFsGm2Lw8QDlQze8Y5lN1E0jiUkngq4xWAfv+8L
i0fD74pc/KiGwbb6aQFOGis4d8Rnahk8cQszKNS4rosnWd3EIPKjkI7n0yje
+0jS0MEgsfGQO21CY0tZR75DJ4OQy13+yzW2fD8sKehmIGEtCjig8RkfMzrx
PQPn5r5VKo1zJDtp+yEG3TtCjR8KaPzL79Dp/GEG4eFtynGNufvP05M/M2BL
lzfZCWlkDTyn341r9k1zY3I1XmrWd3q5moGRaYLLU40NV2iZ1rGc8NvGepau
iMbDNKrAdoITuMN6d3/QOLlmtukpPSeIKrR3RGn8NxKEFSM=
         "]]}}}}, {
    Ticks -> {
       Charting`ScaledTicks[{Log, Exp}], 
       Charting`ScaledTicks[{Log, Exp}]}, GridLines -> {None, None}, 
     FrameTicks -> {{
        Charting`ScaledTicks[{Log, Exp}], 
        Charting`ScaledFrameTicks[{Log, Exp}]}, {
        Charting`ScaledTicks[{Log, Exp}], 
        Charting`ScaledFrameTicks[{Log, Exp}]}}, 
     AxesOrigin -> {-3.5690068424500856`, 1.6953576440952531`}, 
     PlotRange -> {{-3.5690068424500856`, 24.292272679396497`}, {
      1.6953576440952531`, 8.360441904678755}}, DisplayFunction -> Identity, 
     Method -> {
      "DefaultBoundaryStyle" -> Automatic, "DefaultMeshStyle" -> 
       AbsolutePointSize[6], "ScalingFunctions" -> None}, DisplayFunction -> 
     Identity, DisplayFunction -> Identity, 
     Method -> {
      "DefaultBoundaryStyle" -> Automatic, "DefaultMeshStyle" -> 
       AbsolutePointSize[6], "ScalingFunctions" -> None, 
       "ClippingRange" -> {{{-2.302584576087188, 23.0258504130336}, {
        1.9983160195763214`, 8.057483529197686}}, {{-2.302584576087188, 
        23.0258504130336}, {1.9983160195763214`, 8.057483529197686}}}}, 
     DisplayFunction -> Identity, AspectRatio -> 
     NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
     AxesLabel -> {None, None}, AxesOrigin -> {0, 1.8}, 
     CoordinatesToolOptions -> {"DisplayFunction" -> ({
         Exp[
          Part[#, 1]], 
         Exp[
          Part[#, 2]]}& ), "CopiedValueFunction" -> ({
         Exp[
          Part[#, 1]], 
         Exp[
          Part[#, 2]]}& )}, DisplayFunction :> Identity, 
     Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], 
     Method -> {
      "DefaultBoundaryStyle" -> Automatic, "DefaultMeshStyle" -> 
       AbsolutePointSize[6], "ScalingFunctions" -> None}, PlotRange -> 
     NCache[{{-Log[10], 
         Log[10000000000]}, {1.9983160195763214`, 
        8.057483529197686}}, {{-2.302585092994046, 23.025850929940457`}, {
       1.9983160195763214`, 8.057483529197686}}], PlotRangeClipping -> True, 
     PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.05], 
        Scaled[0.05]}}, Ticks -> {Automatic, Automatic}}],FormBox[
    FormBox[
     TemplateBox[{"\"Compton\""}, "LineLegend", DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    AbsoluteThickness[1.6], 
                    RGBColor[1, 0, 0], 
                    Thickness[Large]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    Opacity[1.], 
                    AbsoluteThickness[1.6], 
                    RGBColor[1, 0, 0], 
                    Thickness[Large]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{"Directive", "[", 
               RowBox[{
                 RowBox[{"Opacity", "[", "1.`", "]"}], ",", 
                 RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}], ",", 
                 InterpretationBox[
                  ButtonBox[
                   TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[1, 0, 0], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> RGBColor[0.6666666666666666, 0., 0.], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[1, 0, 0]"], Appearance -> None, BaseStyle -> {},
                    BaselinePosition -> Baseline, DefaultBaseStyle -> {}, 
                   ButtonFunction :> With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[1, 0, 0]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                   Automatic, Method -> "Preemptive"], 
                  RGBColor[1, 0, 0], Editable -> False, Selectable -> False], 
                 ",", 
                 RowBox[{"Thickness", "[", "Large", "]"}]}], "]"}], "}"}], 
           ",", 
           RowBox[{"{", #, "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", "None"}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{
  3.7070793222976418`*^9, {3.707079494577724*^9, 3.707079495994779*^9}, {
   3.707578052244198*^9, 3.7075780539153967`*^9}, 3.707764985065647*^9, 
   3.707765395582345*^9, 3.707765852798843*^9, 3.70777124857609*^9, {
   3.707771422141057*^9, 3.7077714288044233`*^9}, {3.707772988506135*^9, 
   3.707772992595602*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ReplaceAll", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "compton2"}], 
      RowBox[{"(", "5.`*^5", ")"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"me", "\[Rule]", "0.5"}], ",", 
       RowBox[{"\[Alpha]", "\[Rule]", 
        FractionBox["1", "137"]}], ",", 
       RowBox[{"Ef", "\[Rule]", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"3", 
           SuperscriptBox["Pi", "2"], "n"}], ")"}], 
         RowBox[{"1", "/", "3"}]]}]}], "}"}]}], ",", 
    RowBox[{"n", "\[Rule]", "0.8"}]}], "]"}], "/.", 
  RowBox[{"k", "\[Rule]", "2"}]}]], "Input",
 CellChangeTimes->{{3.705167553017742*^9, 3.705167554483663*^9}, {
  3.707765954784396*^9, 3.7077659884213333`*^9}, {3.707766049717328*^9, 
  3.707766052973407*^9}}],

Cell[BoxData[
 RowBox[{"113.89776642109288`", "\[VeryThinSpace]", "-", 
  RowBox[{"58.22152151622446`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{{3.7077659622268047`*^9, 3.707765988704062*^9}, {
  3.70776605183924*^9, 3.707766053286701*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Full Klein-Nishina scattering cross section (averaged over scattering \
angles) - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"k", "=", 
    FractionBox["\[Omega]", 
     SubscriptBox["m", "e"]]}], TraditionalForm]]]
}], "Subsubsection",
 CellChangeTimes->{{3.7044629055937557`*^9, 3.7044629293999033`*^9}, {
   3.7044630035605803`*^9, 3.704463024244062*^9}, 3.705159114455113*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Sigma]", "=", 
   RowBox[{"2", "Pi", 
    FractionBox[
     SuperscriptBox["\[Alpha]", "2"], 
     SuperscriptBox["me", "2"]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"1", "+", "k"}], 
        SuperscriptBox["k", "2"]], 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"2", 
           RowBox[{"(", 
            RowBox[{"1", "+", "k"}], ")"}]}], 
          RowBox[{"1", "+", 
           RowBox[{"2", "k"}]}]], "-", 
         FractionBox[
          RowBox[{"Log", "[", 
           RowBox[{"1", "+", 
            RowBox[{"2", "k"}]}], "]"}], "k"]}], ")"}]}], "+", 
      FractionBox[
       RowBox[{"Log", "[", 
        RowBox[{"1", "+", 
         RowBox[{"2", "k"}]}], "]"}], 
       RowBox[{"2", "k"}]], "-", 
      FractionBox[
       RowBox[{"1", "+", 
        RowBox[{"3", "k"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", "k"}]}], ")"}], "2"]]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.703428168240037*^9, 3.70342831459389*^9}, {
  3.70447911235069*^9, 3.704479116562869*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Two limits:", "Subsubsection",
 CellChangeTimes->{{3.704462931295876*^9, 3.704462932576047*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Normal", "[", 
  RowBox[{"Series", "[", 
   RowBox[{"\[Sigma]", ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7034291277677107`*^9, 3.7034291370823193`*^9}, {
  3.7044791241141653`*^9, 3.704479133018051*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"8", " ", "\[Pi]", " ", 
   SuperscriptBox["\[Alpha]", "2"]}], 
  RowBox[{"3", " ", 
   SuperscriptBox["me", "2"]}]]], "Output",
 CellChangeTimes->{{3.703429133535371*^9, 3.7034291372894983`*^9}, 
   3.703525266844677*^9, 3.704479133607291*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"\[Sigma]", "/.", 
       RowBox[{"k", "\[Rule]", 
        FractionBox["1", "x"]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], "/.", 
   RowBox[{"x", "\[Rule]", 
    FractionBox["me", "\[Omega]"]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.703429159390823*^9, 3.703429243645405*^9}, {
  3.704462939546764*^9, 3.7044629423159103`*^9}, {3.7044632389450293`*^9, 
  3.7044632711915703`*^9}, {3.7044791384371433`*^9, 3.7044791429325*^9}, {
  3.704479176902726*^9, 3.704479187102213*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[Pi]", " ", 
   SuperscriptBox["\[Alpha]", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"Log", "[", "4", "]"}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"Log", "[", 
       FractionBox["me", "\[Omega]"], "]"}]}]}], ")"}]}], 
  RowBox[{"2", " ", "me", " ", "\[Omega]"}]]], "Output",
 CellChangeTimes->{{3.7044632460666227`*^9, 3.704463271495112*^9}, {
  3.704479174098599*^9, 3.704479189403111*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 675},
WindowMargins->{{169, Automatic}, {Automatic, 45}},
Magnification:>1.25 Inherited,
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 10, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 229, 4, 57, "Input"],
Cell[812, 28, 428, 10, 70, "Message"]
}, Open  ]],
Cell[1255, 41, 3707, 113, 381, "Input"],
Cell[CellGroupData[{
Cell[4987, 158, 110, 1, 43, "Subsubsection"],
Cell[5100, 161, 751, 24, 73, "Input"],
Cell[CellGroupData[{
Cell[5876, 189, 1968, 62, 226, "Input"],
Cell[7847, 253, 380, 12, 58, "Output"]
}, Open  ]],
Cell[8242, 268, 1436, 44, 177, "Input"],
Cell[CellGroupData[{
Cell[9703, 316, 1632, 44, 209, "Input"],
Cell[11338, 362, 13442, 267, 294, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24817, 634, 807, 23, 95, "Input"],
Cell[25627, 659, 256, 4, 35, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[25932, 669, 395, 10, 83, "Subsubsection"],
Cell[26330, 681, 1158, 38, 66, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27525, 724, 102, 1, 43, "Subsubsection"],
Cell[CellGroupData[{
Cell[27652, 729, 305, 7, 35, "Input"],
Cell[27960, 738, 282, 7, 61, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28279, 750, 671, 16, 75, "Input"],
Cell[28953, 768, 461, 12, 126, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
